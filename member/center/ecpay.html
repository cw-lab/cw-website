<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0" />
    <title>信用卡資訊-綠界科技ECPay</title>
    <link href="https://payment-stage.ecpay.com.tw/Content/themes/suntory/css/reset.css" rel="stylesheet" type="text/css" />
    <link href="https://payment-stage.ecpay.com.tw/Content/themes/suntory/css/suntory.css" rel="stylesheet" type="text/css" />
</head>

<body>
    <header>
        <div class="pagetop header-img">
            <div class="container">
                <img class="logo" src="https://payment-stage.ecpay.com.tw/Content/images/logo.svg" alt="綠界科技ECPay" />
            </div>
        </div>
    </header>
    <div class="main part identity header-img">
        <div class="container">
            <div class="pay_content">
                <div class="order">
                    <h2>信用卡資訊</h2>
                </div>
                <div class="binding">
                    <p class="info">請輸入信用卡相關資訊</p>
                    <form action="/Binding/AddCreditCard" method="post"><input data-val="true" data-val-number="The field PlatformID must be a number." data-val-required="PlatformID 欄位是必要項。" id="PlatformID" name="PlatformID" type="hidden" value="0" /><input data-val="true" data-val-number="The field MerchantID must be a number."
                            data-val-required="MerchantID 欄位是必要項。" id="MerchantID" name="MerchantID" type="hidden" value="3002607" /><input id="MerchantMemberID" name="MerchantMemberID" type="hidden" value="ISbd31831077bf11e984d065c9aad5" /><input id="MerchantTradeNo"
                            name="MerchantTradeNo" type="hidden" value="IS521000280" /><input id="TradeNo" name="TradeNo" type="hidden" value="20200703170203" /><input id="ServerReplyURL" name="ServerReplyURL" type="hidden" value="https://dev-payment.cwg.tw/test/callback"
                        /><input id="ClientRedirectURL" name="ClientRedirectURL" type="hidden" value="https://dev-api.cwg.tw/redirect/payment/green-world-binding-card-callback" /><input id="CardID" name="CardID" type="hidden" value="" /><input id="NewAI"
                            name="NewAI" type="hidden" value="1" />
                        <div class="card-tb">
                            <div class="card-tr">
                                <div class="card-td align_c cell1"><label>新信用卡卡號</label>
                                </div>
                                <div class="card-td cell2">
                                    <input MaxLength="4" class="input-width creditNum" data-val="true" data-val-regex="信用卡格式錯誤" data-val-regex-pattern="^[0-9]{4}$" data-val-required="卡號不可空白" id="CardPart1" name="CardPart1" type="text" value="" /> -
                                    <input MaxLength="4" class="input-width creditNum" data-val="true" data-val-regex="信用卡格式錯誤" data-val-regex-pattern="^[0-9]{4}$" data-val-required="卡號不可空白" id="CardPart2" name="CardPart2" type="text" value="" /> -
                                    <input MaxLength="4" class="input-width creditNum" data-val="true" data-val-regex="信用卡格式錯誤" data-val-regex-pattern="^[0-9]{4}$" data-val-required="卡號不可空白" id="CardPart3" name="CardPart3" type="text" value="" /> -
                                    <input MaxLength="4" class="input-width creditNum" data-val="true" data-val-regex="信用卡格式錯誤" data-val-regex-pattern="^[0-9]{4}$" data-val-required="卡號不可空白" id="Card4No" name="Card4No" type="text" value="" />
                                    <!-- 提示文字訊息 -->
                                    <div class="alert_box1 input_info creditNum1">
                                        <div class="arrow_b"></div>
                                        <div class="mid">請輸入您的信用卡卡號。</div>
                                    </div>

                                    <div class="alert_box1 error input_error creditNum3">
                                        <div class="arrow_r"></div>
                                        <div class="mid">請輸入您的信用卡卡號。</div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-tr">
                                <div class="card-td align_c cell1"><label>新信用卡有效月/年</label>
                                </div>
                                <div class="card-td cell2">
                                    <select tabindex="5" name="AuthExpireDateMM" id="AuthExpireDateMM">
                  <option value="">請選擇</option>
                  <option value="01">01</option>
                  <option value="02">02</option>
                  <option value="03">03</option>
                  <option value="04">04</option>
                  <option value="05">05</option>
                  <option value="06">06</option>
                  <option value="07">07</option>
                  <option value="08">08</option>
                  <option value="09">09</option>
                  <option value="10">10</option>
                  <option value="11">11</option>
                  <option value="12">12</option>
                </select> 月/
                                    <select tabindex="4" name="AuthExpireDateYY" id="AuthExpireDateYY">
                  <option value="">請選擇</option>
                            <option>2020</option>
                            <option>2021</option>
                            <option>2022</option>
                            <option>2023</option>
                            <option>2024</option>
                            <option>2025</option>
                            <option>2026</option>
                            <option>2027</option>
                            <option>2028</option>
                            <option>2029</option>
                            <option>2030</option>
                            <option>2031</option>
                            <option>2032</option>
                            <option>2033</option>
                            <option>2034</option>
                            <option>2035</option>
                            <option>2036</option>
                            <option>2037</option>
                            <option>2038</option>
                            <option>2039</option>
                            <option>2040</option>
                </select> 年

                                    <!-- 提示文字訊息 -->
                                    <div class="alert_box2 input_error AuthExpireDateMM_empty">
                                        <div class="arrow_b"></div>
                                        <div class="mid">請選擇有效月/年。</div>
                                    </div>
                                    <!-- 輸入錯誤訊息 -->
                                    <div class="alert_box2 error input_error AuthExpireDateMMYY_empty">
                                        <div class="arrow_r"></div>
                                        <div class="mid">請選擇有效月/年。</div>
                                    </div>
                                    <div class="alert_box2 error input_error CardValid_err">
                                        <div class="arrow_r"></div>
                                        <div class="mid">信用卡有效期限錯誤！</div>
                                    </div>
                                </div>
                            </div>
                            <div class="card-tr">
                                <div class="card-td align_c cell1"><label>新信用卡背面末三碼</label>
                                </div>
                                <div class="card-td cell2">
                                    <input MaxLength="3" class="input-width" data-val="true" data-val-regex="末3碼格式錯誤" data-val-regex-pattern="^[0-9]{3}$" data-val-required="末3碼不可空白" id="AuthCode" name="AuthCode" type="text" value="" />
                                    <img src="https://payment-stage.ecpay.com.tw/Content/images/ccvb.png" style=" vertical-align:middle; width:70px;"><br />
                                    <span class="red text-normal">（此欄位為驗證之需，綠界科技不予以記錄）</span>
                                    <!-- 提示文字訊息 -->
                                    <div class="alert_box3 hit AuthCode_focus">
                                        <div class="arrow_b"></div>
                                        <div class="mid">請輸入信用卡背面末三碼。</div>
                                    </div>
                                    <!-- 欄位未填訊息 -->
                                    <div class="alert_box3 error error_box AuthCode_empty">
                                        <div class="arrow_r"></div>
                                        <div class="mid">請輸入信用卡背面末三碼。</div>
                                    </div>
                                    <div class="alert_box3 error error_box AuthCode_OtherErr"></div>
                                    <!-- 輸入錯誤訊息 -->
                                    <div class="alert_box3 error error_box AuthCode_err">
                                        <div class="arrow_r"></div>
                                        <div class="mid">請輸入信用卡背面末三碼。</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <div class="btnarea clearfix div_center">
                    <a id="btn_submit" class="btn blue_button width rightbtn" style="float: none;margin:5px auto 10px auto;">送出</a>
                </div>
            </div>
        </div>
    </div>
    <!-- mobil: Footer -->
    <footer class="footer-m">
        <div class="footer">
            <div class="f-certified">
                <img src="https://payment-stage.ecpay.com.tw/Content/images/comodo_secure_seal_100x85_transp.png" />
                <br /><br />
                <div class="fc-txt">SSL Certificate</div>
            </div>
            <p>金流服務由 綠界科技ECPay 提供</p>
            <p>02-2655-1775 (09:00-18:00)</p>
            <ul class="f-link-list">
                <li><a href="https://www-stage.ecpay.com.tw/CreditCard/Privacy" target="_blank">隱私權政策</a></li>
                <li><a href="https://www-stage.ecpay.com.tw/About/return" target="_blank">退/換貨提醒</a></li>
            </ul>
            <div class="cr pd10">
                <p class="crtxt">Copyright © 1996-2020 Green World FinTech Service Co., Ltd. All rights reserved.</p>
            </div>
        </div>
    </footer>
    <!-- mobil: Footer -->
    <!--pc:Footer-->

    <div class="footer-pc sell_footer">
        <div class="container relative">
            <div class="sf-content">
                <p class="sfc-txt">金流服務由 綠界科技ECPay 提供</p>
                <p class="sfc-txt"><span>02-2655-1775 (09:00 – 18:00)</span></p>
                <dl class="sfc-list">
                    <dt><a href="https://www-stage.ecpay.com.tw/CreditCard/Privacy" target="_blank">隱私權政策</a></dt>
                    <dt><a href="https://www-stage.ecpay.com.tw/About/return" target="_blank">退/換貨提醒</a></dt>
                </dl>
                <p class="sfc-copyright"><span id="_footerCopyright">Copyright © 1996-2020 Green World FinTech Service Co., Ltd. All rights reserved.</span></p>
            </div>
            <div class="sf-certified">
                <img src="https://payment-stage.ecpay.com.tw/Content/images/comodo_secure_seal_100x85_transp.png" />
                <br /><br />
                <p class="sfc-txt">SSL Certificate</p>
            </div>
        </div>
    </div>
    <!--pc:Footer-->
    <script src="https://payment-stage.ecpay.com.tw/scripts/jquery-1.7.2.min.js" type="text/javascript"></script>
    <script type="text/javascript">
        $(function() {
            $('.creditNum').keyup(function() {
                var inputs = $('.creditNum');

                if ($(this).val().length == 4) {
                    inputs.eq(inputs.index($(this)) + 1).focus();
                }
            });

            //###欄位提示的div，先全部hide
            $('.alert_box1').hide();
            $('.alert_box2').hide();
            $('.alert_box3').hide();

            var regPass = /^[0-9]{4}$/;
            //半型判斷
            var regAuthCode = /^[0-9]{3}$/;

            $('#CardPart1').focus(function() {
                $('.creditNum1').addClass("CardPart1_focus");
                $('.creditNum2').addClass("CardPart1_empty");
                $('.creditNum3').addClass("CardPart1_err");
                checkOnFocus('CardPart1');
            });

            $('#CardPart1').blur(function() {
                checkOnBlur('CardPart1', regPass);
                $('.creditNum1').removeClass("CardPart1_focus");
                $('.creditNum2').removeClass("CardPart1_empty");
                $('.creditNum3').removeClass("CardPart1_err");
                //ChkCreditCard();
                ChkCardType(this.value);
            });

            function ChkCardType(str) {
                if (str.length == 4) {
                    $(".picCreadit").fadeOut();
                    var cardType = str.substr(0, 1);
                    if (cardType == "4") {
                        $("#visa").fadeIn();
                    } else if (cardType == "5") {
                        $("#master").fadeIn();
                    } else if (cardType == "1" || cardType == "2" || cardType == "3") {
                        $("#jbc").fadeIn();
                    }
                }
            }

            $('#CardPart2').focus(function() {
                $('.creditNum1').addClass("CardPart2_focus");
                $('.creditNum2').addClass("CardPart2_empty");
                $('.creditNum3').addClass("CardPart2_err");
                checkOnFocus('CardPart2');
            });

            $('#CardPart2').blur(function() {
                checkOnBlur('CardPart2', regPass);
                $('.creditNum1').removeClass("CardPart2_focus");
                $('.creditNum2').removeClass("CardPart2_empty");
                $('.creditNum3').removeClass("CardPart2_err");
                //ChkCreditCard();
            });
            $('#CardPart3').focus(function() {
                $('.creditNum1').addClass("CardPart3_focus");
                $('.creditNum2').addClass("CardPart3_empty");
                $('.creditNum3').addClass("CardPart3_err");
                checkOnFocus('CardPart3');
            });

            $('#CardPart3').blur(function() {
                checkOnBlur('CardPart3', regPass);
                $('.creditNum1').removeClass("CardPart3_focus");
                $('.creditNum2').removeClass("CardPart3_empty");
                $('.creditNum3').removeClass("CardPart3_err");
                //ChkCreditCard();
            });

            $('#Card4No').focus(function() {
                $('.creditNum1').addClass("Card4No_focus");
                $('.creditNum2').addClass("Card4No_empty");
                $('.creditNum3').addClass("Card4No_err");
                checkOnFocus('Card4No');
            });

            $('#Card4No').blur(function() {
                checkOnBlur('Card4No', regPass);
                $('.creditNum1').removeClass("Card4No_focus");
                $('.creditNum2').removeClass("Card4No_empty");
                $('.creditNum3').removeClass("Card4No_err");
                ChkCreditCard();
            });

            $('#AuthExpireDateMM').click(function() {
                checkeffectDate();
            });

            $('#AuthExpireDateYY').click(function() {
                checkeffectDate();
            });


            $('#AuthCode').focus(function() {
                checkOnFocus('AuthCode');
            });

            $('#AuthCode').blur(function() {
                checkOnBlur('AuthCode', regAuthCode);
            });

            function checkOnFocus(propID) {
                $('#' + propID).removeClass('error');
                $('#' + propID).addClass('hit');

                //未輸入值時，出現提示文字
                var prop_focus = propID + '_focus';
                var prop_empty = propID + '_empty';
                var prop_err = propID + '_err';
                var prop_OtherErr = propID + '_OtherErr';

                $('.' + prop_OtherErr).hide();
                $('.' + prop_empty).hide();
                $('.' + prop_err).hide();
                $('.' + prop_focus).fadeIn();
            }

            function checkOnBlur(propID, regEx) {
                //先移除欄位的外框線
                $('#' + propID).removeClass('error');
                $('#' + propID).addClass('hit');

                var reg = regEx;
                var checkVal = $('#' + propID).val();

                var prop_focus = propID + '_focus';
                var prop_empty = propID + '_empty';
                var prop_err = propID + '_err';
                var prop_OtherErr = propID + '_OtherErr';

                $('.' + prop_OtherErr).hide();

                //欄位為空值
                if ($('#' + propID).val() == '') {
                    $('.' + prop_focus).hide();
                    $('.' + prop_err).hide();
                    $('.' + prop_empty).fadeIn();
                    $('#' + propID).addClass('error');

                    return false;
                    //欄位格式不正確
                } else if (!reg.test(checkVal, reg)) {
                    $('.' + prop_focus).hide();
                    $('.' + prop_empty).hide();
                    $('.' + prop_err).fadeIn();
                    $('#' + propID).addClass('error');

                    return false;
                    //欄位格式正確
                } else if (reg.test(checkVal, reg)) {
                    $('.' + prop_focus).hide();
                    $('.' + prop_empty).hide();
                    $('.' + prop_err).hide();
                    $('#' + propID).removeClass('error');
                    return true;
                }
            }

            function checkeffectDate() {
                var mm = $('#AuthExpireDateMM option:selected').val();
                var yy = $('#AuthExpireDateYY option:selected').val();

                $('.AuthExpireDateMMYY_empty').hide();
                $('.AuthExpireDateMM_empty').hide();
                $('.AuthExpireDateYY_empty').hide();
                $('.CardValid_err').hide();

                if (mm == '' && yy == '') {
                    $('.AuthExpireDateMMYY_empty').show();
                    return false;
                } else if (mm == '' && yy != '') {
                    $('.AuthExpireDateMM_empty').show();
                    return false;
                } else if (mm != '' && yy == '') {
                    $('.AuthExpireDateYY_empty').show();
                    return false;
                } else {
                    return true;
                }
            }

            function checkOnBlurPass(propID) {
                //先移除欄位的外框線
                $('#' + propID).removeClass('error');
                $('#' + propID).addClass('hit');

                //未輸入值時，出現提示文字
                var prop_focus = propID + '_focus';
                var prop_empty = propID + '_empty';
                var prop_err = propID + '_err';
                var prop_OtherErr = propID + '_OtherErr';

                if ($('#' + propID).val() == '') {
                    $('.' + prop_focus).hide();
                    $('.' + prop_err).hide();
                    $('.' + prop_empty).fadeIn();
                    $('#' + propID).addClass('error');
                    return false;
                    //欄位格式不正確
                } else {
                    $('.' + prop_focus).hide();
                    $('.' + prop_empty).hide();
                    $('.' + prop_err).hide();
                    $('#' + propID).removeClass('error');
                    return true;
                }
            }
        });

        function ChkCreditCard() {
            var CardPart1 = $('#CardPart1').val();
            var CardPart2 = $('#CardPart2').val();
            var CardPart3 = $('#CardPart3').val();
            var Card4No = $('#Card4No').val();
            var s = CardPart1 + CardPart2 + CardPart3 + Card4No;
            if (s.length <= 15) {
                showChk(false);
                return false;
            }
            var chkCode = 0;
            if (s.length != 16) {
                showChk(false);
                return false;
            }
            if (!$.isNumeric(s)) {
                showChk(false);
                return false;
            }

            //測試環境不驗證
            if ('0' != "1") {
                showChk(true);
                return true;
            }

            //驗證卡號
            for (var i = s.length; i > 0; i--) {
                var cilentCode = s.substring((17 - i - 1), (17 - i));
                if (isNaN(cilentCode)) {
                    showChk(false);
                    return false;
                }
                var sumCode = cilentCode * ((i + 1) % 2 + 1);
                chkCode += (sumCode - sumCode % 10) / 10 + (sumCode % 10);
            }
            if (chkCode % 10 == 0) {
                showChk(true);
                return true;
            } else {
                showChk(false);
                return false;
            }
        }

        function showChk(isOK) {
            if (!$('.creditNum3').is(':visible')) {
                $('.creditNum1').fadeOut();
                $('.creditNum2').fadeOut();
                $('.creditNum3').fadeOut();
                if (!isOK) {
                    $('.creditNum3').fadeIn();
                    $('.creditNum3').html('<div class="arrow_r"></div> <div class="mid">非有效卡號，請重新輸入。</div>');
                } else {
                    $('.creditNum3').html('<div class="arrow_r"></div> <div class="mid">卡號格式錯誤，請重新輸入。</div>');
                }
            }
        }
        $("#btn_submit").click(function() {
            var referrer = document.referrer;
            window.location.href = referrer + '?addNewCreditSuccess';
        });
    </script>
</body>

</html>